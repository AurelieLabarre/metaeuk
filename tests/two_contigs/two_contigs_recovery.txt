### test 3: recover a proteins on several contigs ###

# the followong fake transcript has 3 exons - separated by "|": (330 nucs = 110 aas; 402 nucs = 134 aas; 180 nucs = 60 aas)
ATGACTTTATGCGCAGGTTTTGACCCTAATCGATTTTTGCCCATCGTTCTCGACGTTGGCACCAACAATGAAACCCATCGTAAAAATCATCAATACATGGGTTTAAGAAAGGACCGTGTTCACGGTGAGCAGTATGACATCTTTTTGGAGAACGTTATTAAAGCCATTCGTGAAGTCTTTCCCGAGGCCTTTATTCACTTTGAGGATTTCGGACTTAAAAATGCCAAAAGGATTTTAGACCACTATCGTCCTAATATTGCCTGTTTTAACGATGATATCCAGGGCACCGGTGCTGTAGCACTGGCCGCCATTATAGGCGCCCTTCATGTT|ACGAAGTCTCCCTTAACCGAGCAGCGCATCATGATCTTTGGTGCTGGTACTGCTGGTGTTGGTATCGCCAACCAAATTGTCGCTGGTATGGTGACAGATGGCCTTTCATTAGGTAAGGCTAGAGATAATCTTTTCATGATTGATCGATGCGGTTTGCTTCTGGAGAGACATGCTAAGATTGCTACTGATGGACAAAAGCCATTTTTGAAGAAGGACTCAGACTTTAAGGAAGTCCCTTCTGGAGACATTGATTTAGAGACTGCTATTTCACTAATCAAACCCACTGTTCTTCTGGGGTGCTCCGGTCAACCTGGAAAATTTACAGAAAAGGCCATTCGTGAAATGAGCAAGCATGTCAAACATCCCATCATCTTCCCAATCTCTAACCCCACCACTCTCATG|GAAGCAAAGCCCGTTCAAATTGACGAATGGTCTAATGGTAAAGCTTTGATGGCAACTGGTTCTCCACTTCCTCCTCTCACACGTAATGGTAAAGAATATGTGATTTCTCAATGCAATAATGCTCTTCTTTACCCTGCTCTAGGTGTTGCATGTGTGTTATCCCGTTGCAAATTGTTGAGC

# the followong fake transcript has 2 exons - separated by "|": (330 nucs = 110 aas; 243 nucs = 81 aas)
ATGACTTTATGCGCAGGTTTTGACCCTAATCGATTTTTGCCCATCGTTCTCGACGTTGGCACCAACAATGAAACCCATCGTAAAAATCATCAATACATGGGTTTAAGAAAGGACCGTGTTCACGGTGAGCAGTATGACATCTTTTTGGAGAACGTTATTAAAGCCATTCGTGAAGTCTTTCCCGAGGCCTTTATTCACTTTGAGGATTTCGGACTTAAAAATGCCAAAAGGATTTTAGACCACTATCGTCCTAATATTGCCTGTTTTAACGATGATATCCAGGGCACCGGTGCTGTAGCACTGGCCGCCATTATAGGCGCCCTTCATGTT|GATGGAATGCTGAAAGCAGCTTCCGATGCTTTGGCCACTGTTCCTAGATCTTTGTTTGTCGCCGATGAAGCTCTCTTGCCAGATCTGGACAATGCTCGAGAAATCTCTCGTCACATCGTTTTTGCGGTTTTGAAGCAAGCCATTTCTGAAGGAATGAGCACAGTGGATTTACCCAAAGATGATGCCAAGTTGAAGGAATGGATTATTGAACGAGAATGGAACCCTGAATACAGGAATTTTGTA

# this is their transaltion (exons separated by "|")
MTLCAGFDPNRFLPIVLDVGTNNETHRKNHQYMGLRKDRVHGEQYDIFLENVIKAIREVFPEAFIHFEDFGLKNAKRILDHYRPNIACFNDDIQGTGAVALAAIIGALHV|TKSPLTEQRIMIFGAGTAGVGIANQIVAGMVTDGLSLGKARDNLFMIDRCGLLLERHAKIATDGQKPFLKKDSDFKEVPSGDIDLETAISLIKPTVLLGCSGQPGKFTEKAIREMSKHVKHPIIFPISNPTTLM|EAKPVQIDEWSNGKALMATGSPLPPLTRNGKEYVISQCNNALLYPALGVACVLSRCKLLS

MTLCAGFDPNRFLPIVLDVGTNNETHRKNHQYMGLRKDRVHGEQYDIFLENVIKAIREVFPEAFIHFEDFGLKNAKRILDHYRPNIACFNDDIQGTGAVALAAIIGALHV|DGMLKAASDALATVPRSLFVADEALLPDLDNAREISRHIVFAVLKQAISEGMSTVDLPKDDAKLKEWIIEREWNPEYRNFV


# the following is an embedding of the exons in non-coding segments (lower case).
>my_multi_exon_contig_1
tcgtggagcgccgaggcgaaggatctgaggtcaccggcgctagaccgtctccgaccgtacattggagcacgacatgacctaagttcgtgataaatccaacATGACTTTATGCGCAGGTTTTGACCCTAATCGATTTTTGCCCATCGTTCTCGACGTTGGCACCAACAATGAAACCCATCGTAAAAATCATCAATACATGGGTTTAAGAAAGGACCGTGTTCACGGTGAGCAGTATGACATCTTTTTGGAGAACGTTATTAAAGCCATTCGTGAAGTCTTTCCCGAGGCCTTTATTCACTTTGAGGATTTCGGACTTAAAAATGCCAAAAGGATTTTAGACCACTATCGTCCTAATATTGCCTGTTTTAACGATGATATCCAGGGCACCGGTGCTGTAGCACTGGCCGCCATTATAGGCGCCCTTCATGTTtatcctcctgaactagcacatgtaattctgggtcgttactagggtaatctACGAAGTCTCCCTTAACCGAGCAGCGCATCATGATCTTTGGTGCTGGTACTGCTGGTGTTGGTATCGCCAACCAAATTGTCGCTGGTATGGTGACAGATGGCCTTTCATTAGGTAAGGCTAGAGATAATCTTTTCATGATTGATCGATGCGGTTTGCTTCTGGAGAGACATGCTAAGATTGCTACTGATGGACAAAAGCCATTTTTGAAGAAGGACTCAGACTTTAAGGAAGTCCCTTCTGGAGACATTGATTTAGAGACTGCTATTTCACTAATCAAACCCACTGTTCTTCTGGGGTGCTCCGGTCAACCTGGAAAATTTACAGAAAAGGCCATTCGTGAAATGAGCAAGCATGTCAAACATCCCATCATCTTCCCAATCTCTAACCCCACCACTCTCATGctttgattagtttttacggcttctgttccacggttcgacccggcgagctttactggcaacgtatacacccccctcgtaccGAAGCAAAGCCCGTTCAAATTGACGAATGGTCTAATGGTAAAGCTTTGATGGCAACTGGTTCTCCACTTCCTCCTCTCACACGTAATGGTAAAGAATATGTGATTTCTCAATGCAATAATGCTCTTCTTTACCCTGCTCTAGGTGTTGCATGTGTGTTATCCCGTTGCAAATTGTTGAGCggtttctgagcccctgccgatagagaccactgagatggtgatctcggaaacaacgaatac
>my_multi_exon_contig_2
tcgtggagcgccgaggcgaaggatctgaggtcaccggcgctagaccgtctccgaccgtacattggagcacgacatgacctaagttcgtgataaatccaacATGACTTTATGCGCAGGTTTTGACCCTAATCGATTTTTGCCCATCGTTCTCGACGTTGGCACCAACAATGAAACCCATCGTAAAAATCATCAATACATGGGTTTAAGAAAGGACCGTGTTCACGGTGAGCAGTATGACATCTTTTTGGAGAACGTTATTAAAGCCATTCGTGAAGTCTTTCCCGAGGCCTTTATTCACTTTGAGGATTTCGGACTTAAAAATGCCAAAAGGATTTTAGACCACTATCGTCCTAATATTGCCTGTTTTAACGATGATATCCAGGGCACCGGTGCTGTAGCACTGGCCGCCATTATAGGCGCCCTTCATGTTtatcctcctgaactagcacatgtaattctgggtcgttactagggtaatctGATGGAATGCTGAAAGCAGCTTCCGATGCTTTGGCCACTGTTCCTAGATCTTTGTTTGTCGCCGATGAAGCTCTCTTGCCAGATCTGGACAATGCTCGAGAAATCTCTCGTCACATCGTTTTTGCGGTTTTGAAGCAAGCCATTTCTGAAGGAATGAGCACAGTGGATTTACCCAAAGATGATGCCAAGTTGAAGGAATGGATTATTGAACGAGAATGGAACCCTGAATACAGGAATTTTGTAgtaggctgccccatctcttaggtatgtaaagccgccaaattaacggtccagaacgagctgtgggatggttcgtagtggcagatgaacggg


# now create a DB of five proteins - this will cause multiple reports of the protein:
>identical_all_3_exons
MTLCAGFDPNRFLPIVLDVGTNNETHRKNHQYMGLRKDRVHGEQYDIFLENVIKAIREVFPEAFIHFEDFGLKNAKRILDHYRPNIACFNDDIQGTGAVALAAIIGALHVTKSPLTEQRIMIFGAGTAGVGIANQIVAGMVTDGLSLGKARDNLFMIDRCGLLLERHAKIATDGQKPFLKKDSDFKEVPSGDIDLETAISLIKPTVLLGCSGQPGKFTEKAIREMSKHVKHPIIFPISNPTTLMEAKPVQIDEWSNGKALMATGSPLPPLTRNGKEYVISQCNNALLYPALGVACVLSRCKLLS
>identical_all_2_exons
MTLCAGFDPNRFLPIVLDVGTNNETHRKNHQYMGLRKDRVHGEQYDIFLENVIKAIREVFPEAFIHFEDFGLKNAKRILDHYRPNIACFNDDIQGTGAVALAAIIGALHVDGMLKAASDALATVPRSLFVADEALLPDLDNAREISRHIVFAVLKQAISEGMSTVDLPKDDAKLKEWIIEREWNPEYRNFV
>identical_exon1
MTLCAGFDPNRFLPIVLDVGTNNETHRKNHQYMGLRKDRVHGEQYDIFLENVIKAIREVFPEAFIHFEDFGLKNAKRILDHYRPNIACFNDDIQGTGAVALAAIIGALHV
>identical_exon2
TKSPLTEQRIMIFGAGTAGVGIANQIVAGMVTDGLSLGKARDNLFMIDRCGLLLERHAKIATDGQKPFLKKDSDFKEVPSGDIDLETAISLIKPTVLLGCSGQPGKFTEKAIREMSKHVKHPIIFPISNPTTLM
>identical_exon4
DGMLKAASDALATVPRSLFVADEALLPDLDNAREISRHIVFAVLKQAISEGMSTVDLPKDDAKLKEWIIEREWNPEYRNFV

# the result should be 4 hits for contig1 (not exon 4) and 4 hits for contig2 (not exon2)

### run test ###
cd /home/eli/postdoc/unitests/two_contigs
/home/eli/postdoc/metaeuk/build/src/metaeuk createdb data/contigs.fna contigs --dont-split-seq-by-len
/home/eli/postdoc/metaeuk/build/src/metaeuk createdb data/proteins.faa proteins
/home/eli/postdoc/metaeuk/build/src/metaeuk predictexons contigs proteins final tempFolder
/home/eli/postdoc/metaeuk/build/src/metaeuk reduceredundancy final final tempGroup
/home/eli/postdoc/metaeuk/build/src/metaeuk convert2fasta final_united_exons_aa final_united_exons_aa.fas
/home/eli/postdoc/metaeuk/build/src/metaeuk convert2fasta final_grouped_predictions_rep final_grouped_predictions_rep.fas
/home/eli/postdoc/metaeuk/build/src/metaeuk createtsv final_united_exons_aa final_united_exons_aa final_grouped_predictions final_grouped_predictions.tsv

### the results - ungroupped ###
>identical_all_2_exons|my_multi_exon_contig_2|+|401|3.17553e-118|2|100|722|100[100]:429[429]:330[330]|480[480]:722[722]:243[243]
MTLCAGFDPNRFLPIVLDVGTNNETHRKNHQYMGLRKDRVHGEQYDIFLENVIKAIREVFPEAFIHFEDFGLKNAKRILDHYRPNIACFNDDIQGTGAVALAAIIGALHVDGMLKAASDALATVPRSLFVADEALLPDLDNAREISRHIVFAVLKQAISEGMSTVDLPKDDAKLKEWIIEREWNPEYRNFV
>identical_all_2_exons|my_multi_exon_contig_1|+|235|2.97026e-68|1|100|429|100[100]:429[429]:330[330]
MTLCAGFDPNRFLPIVLDVGTNNETHRKNHQYMGLRKDRVHGEQYDIFLENVIKAIREVFPEAFIHFEDFGLKNAKRILDHYRPNIACFNDDIQGTGAVALAAIIGALHV
>identical_all_3_exons|my_multi_exon_contig_2|+|235|2.97026e-68|1|100|429|100[100]:429[429]:330[330]
MTLCAGFDPNRFLPIVLDVGTNNETHRKNHQYMGLRKDRVHGEQYDIFLENVIKAIREVFPEAFIHFEDFGLKNAKRILDHYRPNIACFNDDIQGTGAVALAAIIGALHV
>identical_all_3_exons|my_multi_exon_contig_1|+|630|3.68084e-187|3|100|1141|100[100]:429[429]:330[330]|480[480]:881[881]:402[402]|944[968]:1141[1141]:198[174]
MTLCAGFDPNRFLPIVLDVGTNNETHRKNHQYMGLRKDRVHGEQYDIFLENVIKAIREVFPEAFIHFEDFGLKNAKRILDHYRPNIACFNDDIQGTGAVALAAIIGALHVTKSPLTEQRIMIFGAGTAGVGIANQIVAGMVTDGLSLGKARDNLFMIDRCGLLLERHAKIATDGQKPFLKKDSDFKEVPSGDIDLETAISLIKPTVLLGCSGQPGKFTEKAIREMSKHVKHPIIFPISNPTTLMKPVQIDEWSNGKALMATGSPLPPLTRNGKEYVISQCNNALLYPALGVACVLSRCKLLS
>identical_exon4|my_multi_exon_contig_2|+|166|1.75333e-47|1|480|722|480[480]:722[722]:243[243]
DGMLKAASDALATVPRSLFVADEALLPDLDNAREISRHIVFAVLKQAISEGMSTVDLPKDDAKLKEWIIEREWNPEYRNFV
>identical_exon2|my_multi_exon_contig_1|+|272|2.16115e-79|1|480|881|480[480]:881[881]:402[402]
TKSPLTEQRIMIFGAGTAGVGIANQIVAGMVTDGLSLGKARDNLFMIDRCGLLLERHAKIATDGQKPFLKKDSDFKEVPSGDIDLETAISLIKPTVLLGCSGQPGKFTEKAIREMSKHVKHPIIFPISNPTTLM
>identical_exon1|my_multi_exon_contig_2|+|235|2.97026e-68|1|100|429|100[100]:429[429]:330[330]
MTLCAGFDPNRFLPIVLDVGTNNETHRKNHQYMGLRKDRVHGEQYDIFLENVIKAIREVFPEAFIHFEDFGLKNAKRILDHYRPNIACFNDDIQGTGAVALAAIIGALHV
>identical_exon1|my_multi_exon_contig_1|+|235|2.97026e-68|1|100|429|100[100]:429[429]:330[330]
MTLCAGFDPNRFLPIVLDVGTNNETHRKNHQYMGLRKDRVHGEQYDIFLENVIKAIREVFPEAFIHFEDFGLKNAKRILDHYRPNIACFNDDIQGTGAVALAAIIGALHV


### the results after groupping ###
>identical_all_2_exons|my_multi_exon_contig_2|+|401|3.17553e-118|2|100|722|100[100]:429[429]:330[330]|480[480]:722[722]:243[243]
MTLCAGFDPNRFLPIVLDVGTNNETHRKNHQYMGLRKDRVHGEQYDIFLENVIKAIREVFPEAFIHFEDFGLKNAKRILDHYRPNIACFNDDIQGTGAVALAAIIGALHVDGMLKAASDALATVPRSLFVADEALLPDLDNAREISRHIVFAVLKQAISEGMSTVDLPKDDAKLKEWIIEREWNPEYRNFV
>identical_all_3_exons|my_multi_exon_contig_1|+|630|3.68084e-187|3|100|1141|100[100]:429[429]:330[330]|480[480]:881[881]:402[402]|944[968]:1141[1141]:198[174]
MTLCAGFDPNRFLPIVLDVGTNNETHRKNHQYMGLRKDRVHGEQYDIFLENVIKAIREVFPEAFIHFEDFGLKNAKRILDHYRPNIACFNDDIQGTGAVALAAIIGALHVTKSPLTEQRIMIFGAGTAGVGIANQIVAGMVTDGLSLGKARDNLFMIDRCGLLLERHAKIATDGQKPFLKKDSDFKEVPSGDIDLETAISLIKPTVLLGCSGQPGKFTEKAIREMSKHVKHPIIFPISNPTTLMKPVQIDEWSNGKALMATGSPLPPLTRNGKEYVISQCNNALLYPALGVACVLSRCKLLS




