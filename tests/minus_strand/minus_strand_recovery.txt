### test 2: recover a multi-exon protein on the minus strand ###

# the followong fake transcript has 2 exons - separated by "|": (330 nucs = 110 aas; 402 nucs = 134 aas)
ATGACTTTATGCGCAGGTTTTGACCCTAATCGATTTTTGCCCATCGTTCTCGACGTTGGCACCAACAATGAAACCCATCGTAAAAATCATCAATACATGGGTTTAAGAAAGGACCGTGTTCACGGTGAGCAGTATGACATCTTTTTGGAGAACGTTATTAAAGCCATTCGTGAAGTCTTTCCCGAGGCCTTTATTCACTTTGAGGATTTCGGACTTAAAAATGCCAAAAGGATTTTAGACCACTATCGTCCTAATATTGCCTGTTTTAACGATGATATCCAGGGCACCGGTGCTGTAGCACTGGCCGCCATTATAGGCGCCCTTCATGTT|ACGAAGTCTCCCTTAACCGAGCAGCGCATCATGATCTTTGGTGCTGGTACTGCTGGTGTTGGTATCGCCAACCAAATTGTCGCTGGTATGGTGACAGATGGCCTTTCATTAGGTAAGGCTAGAGATAATCTTTTCATGATTGATCGATGCGGTTTGCTTCTGGAGAGACATGCTAAGATTGCTACTGATGGACAAAAGCCATTTTTGAAGAAGGACTCAGACTTTAAGGAAGTCCCTTCTGGAGACATTGATTTAGAGACTGCTATTTCACTAATCAAACCCACTGTTCTTCTGGGGTGCTCCGGTCAACCTGGAAAATTTACAGAAAAGGCCATTCGTGAAATGAGCAAGCATGTCAAACATCCCATCATCTTCCCAATCTCTAACCCCACCACTCTCATG

# this is its transaltion (exons separated by "|")
MTLCAGFDPNRFLPIVLDVGTNNETHRKNHQYMGLRKDRVHGEQYDIFLENVIKAIREVFPEAFIHFEDFGLKNAKRILDHYRPNIACFNDDIQGTGAVALAAIIGALHV|TKSPLTEQRIMIFGAGTAGVGIANQIVAGMVTDGLSLGKARDNLFMIDRCGLLLERHAKIATDGQKPFLKKDSDFKEVPSGDIDLETAISLIKPTVLLGCSGQPGKFTEKAIREMSKHVKHPIIFPISNPTTLM

# this is the reverse transcription of each exon - separated by "|", order is reveresed:
CATGAGAGTGGTGGGGTTAGAGATTGGGAAGATGATGGGATGTTTGACATGCTTGCTCATTTCACGAATGGCCTTTTCTGTAAATTTTCCAGGTTGACCGGAGCACCCCAGAAGAACAGTGGGTTTGATTAGTGAAATAGCAGTCTCTAAATCAATGTCTCCAGAAGGGACTTCCTTAAAGTCTGAGTCCTTCTTCAAAAATGGCTTTTGTCCATCAGTAGCAATCTTAGCATGTCTCTCCAGAAGCAAACCGCATCGATCAATCATGAAAAGATTATCTCTAGCCTTACCTAATGAAAGGCCATCTGTCACCATACCAGCGACAATTTGGTTGGCGATACCAACACCAGCAGTACCAGCACCAAAGATCATGATGCGCTGCTCGGTTAAGGGAGACTTCGT|AACATGAAGGGCGCCTATAATGGCGGCCAGTGCTACAGCACCGGTGCCCTGGATATCATCGTTAAAACAGGCAATATTAGGACGATAGTGGTCTAAAATCCTTTTGGCATTTTTAAGTCCGAAATCCTCAAAGTGAATAAAGGCCTCGGGAAAGACTTCACGAATGGCTTTAATAACGTTCTCCAAAAAGATGTCATACTGCTCACCGTGAACACGGTCCTTTCTTAAACCCATGTATTGATGATTTTTACGATGGGTTTCATTGTTGGTGCCAACGTCGAGAACGATGGGCAAAAATCGATTAGGGTCAAAACCTGCGCATAAAGTCAT


# the following is an embedding of the 2 exons in non-coding segments (lower case). The second exon is also on the plus strand:
# intron generation: paste(sample(c("a","c","g","t"), 100, replace = TRUE), collapse = "")
# intron generation: paste(sample(c("a","c","g","t"), 80, replace = TRUE), collapse = "")
# intron generation: paste(sample(c("a","c","g","t"), 90, replace = TRUE), collapse = "")
# intron generation: paste(sample(c("a","c","g","t"), 90, replace = TRUE), collapse = "")

>my_multi_exon_contig
tcgtggagcgccgaggcgaaggatctgaggtcaccggcgctagaccgtctccgaccgtacattggagcacgacatgacctaagttcgtgataaatccaacCATGAGAGTGGTGGGGTTAGAGATTGGGAAGATGATGGGATGTTTGACATGCTTGCTCATTTCACGAATGGCCTTTTCTGTAAATTTTCCAGGTTGACCGGAGCACCCCAGAAGAACAGTGGGTTTGATTAGTGAAATAGCAGTCTCTAAATCAATGTCTCCAGAAGGGACTTCCTTAAAGTCTGAGTCCTTCTTCAAAAATGGCTTTTGTCCATCAGTAGCAATCTTAGCATGTCTCTCCAGAAGCAAACCGCATCGATCAATCATGAAAAGATTATCTCTAGCCTTACCTAATGAAAGGCCATCTGTCACCATACCAGCGACAATTTGGTTGGCGATACCAACACCAGCAGTACCAGCACCAAAGATCATGATGCGCTGCTCGGTTAAGGGAGACTTCGTctttgattagtttttacggcttctgttccacggttcgacccggcgagctttactggcaacgtatacacccccctcgtaccAACATGAAGGGCGCCTATAATGGCGGCCAGTGCTACAGCACCGGTGCCCTGGATATCATCGTTAAAACAGGCAATATTAGGACGATAGTGGTCTAAAATCCTTTTGGCATTTTTAAGTCCGAAATCCTCAAAGTGAATAAAGGCCTCGGGAAAGACTTCACGAATGGCTTTAATAACGTTCTCCAAAAAGATGTCATACTGCTCACCGTGAACACGGTCCTTTCTTAAACCCATGTATTGATGATTTTTACGATGGGTTTCATTGTTGGTGCCAACGTCGAGAACGATGGGCAAAAATCGATTAGGGTCAAAACCTGCGCATAAAGTCATgtaggctgccccatctcttaggtatgtaaagccgccaaattaacggtccagaacgagctgtgggatggttcgtagtggcagatgaacgggACGAAGTCTCCCTTAACCGAGCAGCGCATCATGATCTTTGGTGCTGGTACTGCTGGTGTTGGTATCGCCAACCAAATTGTCGCTGGTATGGTGACAGATGGCCTTTCATTAGGTAAGGCTAGAGATAATCTTTTCATGATTGATCGATGCGGTTTGCTTCTGGAGAGACATGCTAAGATTGCTACTGATGGACAAAAGCCATTTTTGAAGAAGGACTCAGACTTTAAGGAAGTCCCTTCTGGAGACATTGATTTAGAGACTGCTATTTCACTAATCAAACCCACTGTTCTTCTGGGGTGCTCCGGTCAACCTGGAAAATTTACAGAAAAGGCCATTCGTGAAATGAGCAAGCATGTCAAACATCCCATCATCTTCCCAATCTCTAACCCCACCACTCTCATGgtaggctgccccatctcttaggtatgtaaagccgccaaattaacggtccagaacgagctgtgggatggttcgtagtggcagatgaacggg


# now create a DB of three proteins - this will cause multiple reports of the protein:
>identical_all_2_exons
MTLCAGFDPNRFLPIVLDVGTNNETHRKNHQYMGLRKDRVHGEQYDIFLENVIKAIREVFPEAFIHFEDFGLKNAKRILDHYRPNIACFNDDIQGTGAVALAAIIGALHV|TKSPLTEQRIMIFGAGTAGVGIANQIVAGMVTDGLSLGKARDNLFMIDRCGLLLERHAKIATDGQKPFLKKDSDFKEVPSGDIDLETAISLIKPTVLLGCSGQPGKFTEKAIREMSKHVKHPIIFPISNPTTLM
>identical_exon2
TKSPLTEQRIMIFGAGTAGVGIANQIVAGMVTDGLSLGKARDNLFMIDRCGLLLERHAKIATDGQKPFLKKDSDFKEVPSGDIDLETAISLIKPTVLLGCSGQPGKFTEKAIREMSKHVKHPIIFPISNPTTLM
>identical_exon1
MTLCAGFDPNRFLPIVLDVGTNNETHRKNHQYMGLRKDRVHGEQYDIFLENVIKAIREVFPEAFIHFEDFGLKNAKRILDHYRPNIACFNDDIQGTGAVALAAIIGALHV

# the result should be 3 hits for the minus strand (exon1, exon2 and exon1+exon2) and 2 hits for the plus strand (exon2, exon1+exon2)

### run test ###
cd /home/eli/postdoc/unitests/minus_strand
/home/eli/postdoc/metaeuk/build/src/metaeuk createdb data/contigs.fna contigs --dont-split-seq-by-len
/home/eli/postdoc/metaeuk/build/src/metaeuk createdb data/proteins.faa proteins
/home/eli/postdoc/metaeuk/build/src/metaeuk predictexons contigs proteins final tempFolder
/home/eli/postdoc/metaeuk/build/src/metaeuk reduceredundancy final final tempGroup
/home/eli/postdoc/metaeuk/build/src/metaeuk convert2fasta final_united_exons_aa final_united_exons_aa.fas
/home/eli/postdoc/metaeuk/build/src/metaeuk convert2fasta final_grouped_predictions_rep final_grouped_predictions_rep.fas
/home/eli/postdoc/metaeuk/build/src/metaeuk createtsv final_united_exons_aa final_united_exons_aa final_grouped_predictions final_grouped_predictions.tsv

### the results - ungroupped ###
>identical_exon2|my_multi_exon_contig|+|271|2.57757e-79|1|1002|1403|1002[1002]:1403[1403]:402[402]
TKSPLTEQRIMIFGAGTAGVGIANQIVAGMVTDGLSLGKARDNLFMIDRCGLLLERHAKIATDGQKPFLKKDSDFKEVPSGDIDLETAISLIKPTVLLGCSGQPGKFTEKAIREMSKHVKHPIIFPISNPTTLM
>identical_exon2|my_multi_exon_contig|-|273|6.44392e-80|1|100|501|501[501]:100[100]:402[402]
TKSPLTEQRIMIFGAGTAGVGIANQIVAGMVTDGLSLGKARDNLFMIDRCGLLLERHAKIATDGQKPFLKKDSDFKEVPSGDIDLETAISLIKPTVLLGCSGQPGKFTEKAIREMSKHVKHPIIFPISNPTTLM
>identical_all_2_exons|my_multi_exon_contig|+|271|2.57757e-79|1|1002|1403|1002[1002]:1403[1403]:402[402]
TKSPLTEQRIMIFGAGTAGVGIANQIVAGMVTDGLSLGKARDNLFMIDRCGLLLERHAKIATDGQKPFLKKDSDFKEVPSGDIDLETAISLIKPTVLLGCSGQPGKFTEKAIREMSKHVKHPIIFPISNPTTLM
>identical_all_2_exons|my_multi_exon_contig|-|505|9.33665e-150|2|100|911|911[911]:561[561]:351[351]|501[519]:100[100]:402[384]
MTLCAGFDPNRFLPIVLDVGTNNETHRKNHQYMGLRKDRVHGEQYDIFLENVIKAIREVFPEAFIHFEDFGLKNAKRILDHYRPNIACFNDDIQGTGAVALAAIIGALHVGTRGVYTEQRIMIFGAGTAGVGIANQIVAGMVTDGLSLGKARDNLFMIDRCGLLLERHAKIATDGQKPFLKKDSDFKEVPSGDIDLETAISLIKPTVLLGCSGQPGKFTEKAIREMSKHVKHPIIFPISNPTTLM
>identical_exon1|my_multi_exon_contig|-|234|3.54258e-68|1|582|911|911[911]:582[582]:330[330]
MTLCAGFDPNRFLPIVLDVGTNNETHRKNHQYMGLRKDRVHGEQYDIFLENVIKAIREVFPEAFIHFEDFGLKNAKRILDHYRPNIACFNDDIQGTGAVALAAIIGALHV

### the results after groupping ###
>identical_exon2|my_multi_exon_contig|+|271|2.57757e-79|1|1002|1403|1002[1002]:1403[1403]:402[402]
TKSPLTEQRIMIFGAGTAGVGIANQIVAGMVTDGLSLGKARDNLFMIDRCGLLLERHAKIATDGQKPFLKKDSDFKEVPSGDIDLETAISLIKPTVLLGCSGQPGKFTEKAIREMSKHVKHPIIFPISNPTTLM
>identical_all_2_exons|my_multi_exon_contig|-|505|9.33665e-150|2|100|911|911[911]:561[561]:351[351]|501[519]:100[100]:402[384]
MTLCAGFDPNRFLPIVLDVGTNNETHRKNHQYMGLRKDRVHGEQYDIFLENVIKAIREVFPEAFIHFEDFGLKNAKRILDHYRPNIACFNDDIQGTGAVALAAIIGALHVGTRGVYTEQRIMIFGAGTAGVGIANQIVAGMVTDGLSLGKARDNLFMIDRCGLLLERHAKIATDGQKPFLKKDSDFKEVPSGDIDLETAISLIKPTVLLGCSGQPGKFTEKAIREMSKHVKHPIIFPISNPTTLM



